(function(e,t,o,i,n){var r=function(e){"use strict";var r={options:{target:n,include:[],exclude:[],lazyload:!0,role:n,mediator:{publish:function(){}},callbacks:{start:n,cycle:n,complete:n}},f:{teardownFunctions:{},testIncluded:function(e){return t.indexOf(r.options.include,e)>=0?!0:0===r.options.include.length&&0>t.indexOf(r.options.exclude,e)?!0:!1},onStart:function(){r.options.mediator.publish("log","PerfectRunner","Started"),r.options.mediator.publish("start",r.options.role),t.isFunction(r.options.callbacks.start)&&r.options.callbacks.start()},onCycle:function(e){return e.target.error?(r.options.mediator.publish("log","error","PerfectRunner",e.target.error.message),n):(r.options.mediator.publish("log","PerfectRunner","Cycled"),r.options.mediator.publish("log","PerfectRunner",e.target),r.options.mediator.publish("cycle",r.options.role,e),t.isFunction(r.options.callbacks.cycle)&&r.options.callbacks.cycle(e),n)},onComplete:function(){r.options.mediator.publish("log","PerfectRunner","Completed"),r.options.mediator.publish("complete",r.options.role),t.isFunction(r.options.callbacks.complete)&&r.options.callbacks.complete()}}};return t.extend(r.options,e),{add:function(e,i,c){return r.f.testIncluded(e)?(r.suite===n&&(r.suite=new o.Suite),c===n&&(c=function(){}),r.suite.add(e,i,{onComplete:t.bind(c,this),delay:.25,async:!0})):(r.options.mediator.publish("log","PerfectRunner","Ignoring excluded test: "+e),n)},run:function(){var e=this;return r.options.mediator.publish("log","PerfectRunner","Running "+r.options.target),r.suite===n?(r.options.mediator.publish("log","error","PerfectRunner","Add some tests first."),n):(r.suite.on("start",t.bind(r.f.onStart,this)),r.suite.on("cycle",t.bind(r.f.onCycle,this)),r.suite.on("complete",t.bind(r.f.onComplete,this)),r.options.lazyload?i.js(r.options.target,function(){e.publish&&e.publish("log","PerfectRunner","Target loaded: "+r.options.target),r.suite.run()}):r.suite.run(),n)},target:function(){return r.options.target}}};e.PerfectRunner=r})(this,_,Benchmark,LazyLoad),function(e,t,o,i,n,r){var c=function(e){var c={options:{a:r,b:r,include:[],exclude:[],callbacks:{start:r,cycle:r,complete:r},enable_ui:!1,name:"",description:""},benchesA:{},benchesB:{},f:{log:function(e,t,o){var i,n,r,c;2==arguments.length?(i="debug",n="unknown",r=e):3==arguments.length?(i="debug",n=e,r=t):4==arguments.length?(i=e,n=t,r=o):console.error("Perfect.log: invalid number of arguments."),c=n+": "+r,"warn"==i?console.warn(c):"error"==i?console.error(c):"info"==i?console.info(c):"debug"==i?console.debug(c):console.error("Perfect.log: invalid log level: "+e)},init:function(){function e(){c.mediator===r&&(c.mediator=new o,c.mediator.subscribe("log",c.f.log,{priority:10}),c.mediator.subscribe("start",c.f.onStart,{priority:10}),c.mediator.subscribe("cycle",c.f.onCycle,{priority:10}),c.mediator.subscribe("complete",c.f.onComplete,{priority:10}))}function a(){c.options.enable_ui&&c.ui===r&&(c.ui=new n({name:c.options.name,description:c.options.description,mediator:c.mediator}),c.mediator.subscribe("start",c.ui.start,{priority:20}),c.mediator.subscribe("cycle",c.ui.cycle,{priority:20}),c.mediator.subscribe("complete",c.ui.complete,{priority:20}))}function s(){c.callbacksSubscribed||(t.isFunction(c.options.callbacks.start)&&c.mediator.subscribe("start",c.options.callbacks.start,{predicate:function(e){return"a"==e},priority:30}),t.isFunction(c.options.callbacks.start_a)&&c.mediator.subscribe("start",c.options.callbacks.start_a,{predicate:function(e){return"a"==e},priority:31}),t.isFunction(c.options.callbacks.start_b)&&c.mediator.subscribe("start",c.options.callbacks.start_b,{predicate:function(e){return"b"==e},priority:32}),t.isFunction(c.options.callbacks.cycle)&&c.mediator.subscribe("cycle",function(e,t){c.options.callbacks.cycle(t)},{priority:30}),t.isFunction(c.options.callbacks.cycle_a)&&c.mediator.subscribe("cycle",function(e,t){c.options.callbacks.cycle_a(t)},{predicate:function(e){return"a"==e},priority:31}),t.isFunction(c.options.callbacks.cycle_b)&&c.mediator.subscribe("cycle",function(e,t){c.options.callbacks.cycle_b(t)},{predicate:function(e){return"b"==e},priority:32}),t.isFunction(c.options.callbacks.complete)&&c.mediator.subscribe("complete",c.options.callbacks.complete,{predicate:function(e){return"b"==e},priority:32}),t.isFunction(c.options.callbacks.complete_a)&&c.mediator.subscribe("complete",c.options.callbacks.complete_a,{predicate:function(e){return"a"==e},priority:30}),t.isFunction(c.options.callbacks.complete_b)&&c.mediator.subscribe("complete",c.options.callbacks.complete_b,{predicate:function(e){return"b"==e},priority:31}),c.callbacksSubscribed=!0)}function l(){c.a===r&&(c.a=new i({target:c.options.a,role:"a",include:c.options.include,exclude:c.options.exclude,mediator:c.mediator}))}function u(){c.b===r&&(c.b=new i({target:c.options.b,role:"b",include:c.options.include,exclude:c.options.exclude,mediator:c.mediator}))}e(),a(),s(),l(),u()},add:function(e,t,o){c.f.init();var i=c.a.add(e,t,o);if(c.b.add(e,t,o),i!==r){var n=i[i.length-1];c.ui&&c.ui.add(n)}return this},run:function(){c.mediator.publish("log","Perfect","Running a..."),c.a.run()},onStart:function(e){c.mediator.publish("log","Perfect","Started "+e)},onCycle:function(e,t){var o="a"==e?c.benchesA:c.benchesB;if(o[t.target.name]=t.target,"b"==e){var i=c.benchesA[t.target.name],n=t.target,r=n.compare(i),a=100*((n.hz-i.hz)/i.hz);c.mediator.publish("log","Perfect","The percentage change is: "+a.toFixed(2)+"%"),0>r?c.mediator.publish("log","Perfect","'b' can be considered faster than 'a'"):0===r?c.mediator.publish("log","Perfect","There is no statistically significative performance difference between 'a' and 'b'"):c.mediator.publish("log","Perfect","'a' can be considered faster than 'b'")}c.mediator.publish("log","Perfect","Cycled "+e)},onComplete:function(e){c.mediator.publish("log","Perfect","Completed "+e),"a"==e?(c.mediator.publish("log","Perfect","Running b..."),c.b.run()):"b"==e&&c.mediator.publish("log","Perfect","Completed all")}}};return t.extend(c.options,e),{add:c.f.add,run:c.f.run}};e.Perfect=c}(this,_,Mediator,PerfectRunner,PerfectUI);